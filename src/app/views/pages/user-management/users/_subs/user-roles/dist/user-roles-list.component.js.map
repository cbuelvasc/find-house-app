{"version":3,"sources":["user-roles-list.component.ts"],"names":[],"mappings":"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","file":"user-roles-list.component.js","sourcesContent":["// Angular\r\nimport { Component, OnInit, Input } from '@angular/core';\r\n// RxJS\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\n// NGRX\r\nimport { Store, select } from '@ngrx/store';\r\n// Lodash\r\nimport { each, find, remove } from 'lodash';\r\n// State\r\nimport { AppState } from '../../../../../../core/reducers';\r\n// Auth\r\nimport { Role, selectAllRoles } from '../../../../../../core/auth';\r\n\r\n@Component({\r\n\tselector: 'kt-user-roles-list',\r\n\ttemplateUrl: './user-roles-list.component.html'\r\n})\r\nexport class UserRolesListComponent implements OnInit {\r\n\t// Public properties\r\n\t// Incoming data\r\n\t@Input() loadingSubject = new BehaviorSubject<boolean>(false);\r\n\t@Input() rolesSubject: BehaviorSubject<string[]>;\r\n\r\n\t// Roles\r\n\tallUserRoles$: Observable<Role[]>;\r\n\tallRoles: Role[] = [];\r\n\tunassignedRoles: Role[] = [];\r\n\tassignedRoles: Role[] = [];\r\n\troleIdForAdding: string;\r\n\r\n\t/**\r\n\t * Component constructor\r\n\t *\r\n\t * @param store: Store<AppState>\r\n\t */\r\n\tconstructor(private store: Store<AppState>) {}\r\n\r\n\t/**\r\n\t * @ Lifecycle sequences => https://angular.io/guide/lifecycle-hooks\r\n\t */\r\n\r\n\t/**\r\n\t * On init\r\n\t */\r\n\tngOnInit() {\r\n\t\tthis.allUserRoles$ = this.store.pipe(select(selectAllRoles));\r\n\t\tthis.allUserRoles$.subscribe((res: Role[]) => {\r\n\t\t\teach(res, (_role: Role) => {\r\n\t\t\t\tthis.allRoles.push(_role);\r\n\t\t\t\tthis.unassignedRoles.push(_role);\r\n\t\t\t});\r\n\r\n\t\t\teach(this.rolesSubject.value, (roleId: string) => {\r\n\t\t\t\tconst role = find(this.allRoles, (_role: Role) => {\r\n\t\t\t\t\treturn _role.id === roleId;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (role) {\r\n\t\t\t\t\tthis.assignedRoles.push(role);\r\n\t\t\t\t\tremove(this.unassignedRoles, (el) => el.id === role.id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Assign role\r\n\t */\r\n\tassignRole() {\r\n\t\tif (this.roleIdForAdding) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst role = find(this.allRoles, (_role: Role) => {\r\n\t\t\treturn _role.id === (this.roleIdForAdding);\r\n\t\t});\r\n\r\n\t\tif (role) {\r\n\t\t\tthis.assignedRoles.push(role);\r\n\t\t\tremove(this.unassignedRoles, (el) => el.id === role.id);\r\n\t\t\tthis.roleIdForAdding = '';\r\n\t\t\tthis.updateRoles();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unassign role\r\n\t *\r\n\t * @param role: Role\r\n\t */\r\n\tunassingRole(role: Role) {\r\n\t\tthis.roleIdForAdding = '';\r\n\t\tthis.unassignedRoles.push(role);\r\n\t\tremove(this.assignedRoles, el => el.id === role.id);\r\n\t\tthis.updateRoles();\r\n\t}\r\n\r\n\t/**\r\n\t * Update roles\r\n\t */\r\n\tupdateRoles() {\r\n\t\tconst _roles = [];\r\n\t\teach(this.assignedRoles, elem => _roles.push(elem.id));\r\n\t\tthis.rolesSubject.next(_roles);\r\n\t}\r\n}\r\n"]}