{"version":3,"sources":["change-password.component.ts"],"names":[],"mappings":"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","file":"change-password.component.js","sourcesContent":["// Angular\r\nimport { Component, OnInit, ChangeDetectionStrategy, Input } from '@angular/core';\r\nimport { AbstractControl, Validators, FormBuilder } from '@angular/forms';\r\nimport { FormGroup } from '@angular/forms';\r\n// RxJS\r\nimport { BehaviorSubject } from 'rxjs';\r\n// NGRX\r\nimport { Store } from '@ngrx/store';\r\nimport { Update } from '@ngrx/entity';\r\n// Auth\r\nimport { AuthService, UserUpdated, User } from '../../../../../../core/auth/';\r\n// State\r\nimport { AppState } from '../../../../../../core/reducers';\r\n// Layout\r\nimport { LayoutUtilsService, MessageType } from '../../../../../../core/_base/crud';\r\n\r\nexport class PasswordValidation {\r\n\t\r\n\tstatic MatchPassword(AC: AbstractControl) {\r\n\t\tconst password = AC.get('password').value; // to get value in input tag\r\n\t\tconst confirmPassword = AC.get('confirmPassword').value; // to get value in input tag\r\n\t\tif (password !== confirmPassword) {\r\n\t\t\tAC.get('confirmPassword').setErrors({ MatchPassword: true });\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@Component({\r\n\tselector: 'kt-change-password',\r\n\ttemplateUrl: './change-password.component.html',\r\n\t// changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ChangePasswordComponent implements OnInit {\r\n\t// Public properties\r\n\t@Input() userId: string;\r\n\t@Input() loadingSubject = new BehaviorSubject<boolean>(false);\r\n\thasFormErrors = false;\r\n\tuser: User;\r\n\tchangePasswordForm: FormGroup;\r\n\r\n\tconstructor(private fb: FormBuilder, private auth: AuthService, private store: Store<AppState>,\r\n\t\t// tslint:disable-next-line:align\r\n\t\tprivate layoutUtilsService: LayoutUtilsService) {\r\n\t}\r\n\r\n\tngOnInit() {\r\n\t\tthis.loadData();\r\n\t}\r\n\r\n\tloadData() {\r\n\t\tthis.auth.getUserById(this.userId).subscribe(res => {\r\n\t\t\tthis.user = res;\r\n\t\t\tthis.createForm();\r\n\t\t});\r\n\t}\r\n\r\n\tcreateForm() {\r\n\t\tthis.changePasswordForm = this.fb.group({\r\n\t\t\tpassword: ['', Validators.required],\r\n\t\t\tconfirmPassword: ['', Validators.required]\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.hasFormErrors = false;\r\n\t\tthis.loadingSubject.next(false);\r\n\t\tthis.changePasswordForm.markAsPristine();\r\n\t\tthis.changePasswordForm.markAsUntouched();\r\n\t\tthis.changePasswordForm.updateValueAndValidity();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tthis.loadingSubject.next(true);\r\n\t\tthis.hasFormErrors = false;\r\n\t\tconst controls = this.changePasswordForm.controls;\r\n\t\t/** check form */\r\n\t\tif (this.changePasswordForm.invalid) {\r\n\t\t\tObject.keys(controls).forEach(controlName =>\r\n\t\t\t\tcontrols[controlName].markAsTouched()\r\n\t\t\t);\r\n\t\t\tthis.hasFormErrors = true;\r\n\t\t\tthis.loadingSubject.next(false);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.user.password = controls.password.value;\r\n\t\tconst updatedUser: Update<User> = {\r\n\t\t\tid: this.user.id,\r\n\t\t\tchanges: this.user\r\n\t\t};\r\n\r\n\t\tthis.store.dispatch(new UserUpdated({\r\n\t\t\tpartialUser: updatedUser,\r\n\t\t\tuser: this.user\r\n\t\t}));\r\n\r\n\t\tthis.loadData();\r\n\t\tthis.loadingSubject.next(false);\r\n\t\tconst message = `User password successfully has been changed.`;\r\n\t\tthis.layoutUtilsService.showActionNotification(message, MessageType.Update, 5000, true, false);\r\n\t\tthis.reset();\r\n\t}\r\n\r\n\t/**\r\n\t * Close alert\r\n\t *\r\n\t * @param $event: Event\r\n\t */\r\n\tonAlertClose($event) {\r\n\t\tthis.hasFormErrors = false;\r\n\t}\r\n}\r\n"]}