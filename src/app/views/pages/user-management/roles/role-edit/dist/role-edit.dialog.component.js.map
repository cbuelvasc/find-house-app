{"version":3,"sources":["role-edit.dialog.component.ts"],"names":[],"mappings":"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","file":"role-edit.dialog.component.js","sourcesContent":["import { Component, OnInit, Inject, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\nimport { each, find, some } from 'lodash';\r\nimport { Update } from '@ngrx/entity';\r\nimport { Store, select } from '@ngrx/store';\r\nimport { AppState } from '../../../../../core/reducers';\r\n\r\nimport {\r\n\tRole,\r\n\tPermission,\r\n\tselectRoleById,\r\n\tRoleUpdated,\r\n\tselectAllPermissions,\r\n\tselectLastCreatedRoleId,\r\n\tRoleOnServerCreated\r\n} from '../../../../../core/auth';\r\nimport { delay } from 'rxjs/operators';\r\n\r\n@Component({\r\n\tselector: 'app-role-edit-dialog',\r\n\ttemplateUrl: './role-edit.dialog.component.html',\r\n\tchangeDetection: ChangeDetectionStrategy.Default,\r\n})\r\nexport class RoleEditDialogComponent implements OnInit, OnDestroy {\r\n\r\n\trole: Role;\r\n\trole$: Observable<Role>;\r\n\thasFormErrors = false;\r\n\tviewLoading = false;\r\n\tloadingAfterSubmit = false;\r\n\tallPermissions$: Observable<Permission[]>;\r\n\trolePermissions: Permission[] = [];\r\n\r\n\tprivate componentSubscriptions: Subscription;\r\n\r\n\tconstructor(\r\n\t\tpublic dialogRef: MatDialogRef<RoleEditDialogComponent>,\r\n\t\t@Inject(MAT_DIALOG_DATA) public data: any,\r\n\t\tprivate store: Store<AppState>) {\r\n\r\n\t}\r\n\r\n\tngOnInit() {\r\n\t\tif (this.data.roleId) {\r\n\t\t\tthis.role$ = this.store.pipe(select(selectRoleById(this.data.roleId)));\r\n\t\t} else {\r\n\t\t\tconst newRole = new Role();\r\n\t\t\tnewRole.clear();\r\n\t\t\tthis.role$ = of(newRole);\r\n\t\t}\r\n\t\tthis.role$.subscribe(res => {\r\n\t\t\tif (!res) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.role = new Role();\r\n\t\t\tthis.role.id = res.id;\r\n\t\t\tthis.role.title = res.title;\r\n\t\t\tthis.role.permissions = res.permissions;\r\n\t\t\tthis.role.isCoreRole = res.isCoreRole;\r\n\r\n\t\t\tthis.allPermissions$ = this.store.pipe(select(selectAllPermissions));\r\n\t\t\tthis.loadPermissions();\r\n\t\t});\r\n\t}\r\n\r\n\tngOnDestroy() {\r\n\t\tif (this.componentSubscriptions) {\r\n\t\t\tthis.componentSubscriptions.unsubscribe();\r\n\t\t}\r\n\t}\r\n\r\n\tloadPermissions() {\r\n\t\tthis.allPermissions$.subscribe(_allPermissions => {\r\n\t\t\tif (!_allPermissions) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst mainPermissions = _allPermissions.filter(el => !el.parentId);\r\n\t\t\tmainPermissions.forEach((element: Permission) => {\r\n\t\t\t\tconst hasUserPermission = this.role.permissions.some(t => t === element.id);\r\n\t\t\t\tconst rootPermission = new Permission();\r\n\t\t\t\trootPermission.clear();\r\n\t\t\t\trootPermission.isSelected = hasUserPermission;\r\n\t\t\t\trootPermission._children = [];\r\n\t\t\t\trootPermission.id = element.id;\r\n\t\t\t\trootPermission.level = element.level;\r\n\t\t\t\trootPermission.parentId = element.parentId;\r\n\t\t\t\trootPermission.title = element.title;\r\n\t\t\t\tconst children = _allPermissions.filter(el => el.parentId && el.parentId === element.id);\r\n\t\t\t\tchildren.forEach(child => {\r\n\t\t\t\t\tconst hasUserChildPermission = this.role.permissions.some(t => t === child.id);\r\n\t\t\t\t\tconst childPermission = new Permission();\r\n\t\t\t\t\tchildPermission.clear();\r\n\t\t\t\t\tchildPermission.isSelected = hasUserChildPermission;\r\n\t\t\t\t\tchildPermission._children = [];\r\n\t\t\t\t\tchildPermission.id = child.id;\r\n\t\t\t\t\tchildPermission.level = child.level;\r\n\t\t\t\t\tchildPermission.parentId = child.parentId;\r\n\t\t\t\t\tchildPermission.title = child.title;\r\n\t\t\t\t\trootPermission._children.push(childPermission);\r\n\t\t\t\t});\r\n\t\t\t\tthis.rolePermissions.push(rootPermission);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpreparePermissionIds(): string[] {\r\n\t\tconst result = [];\r\n\t\teach(this.rolePermissions, (_root: Permission) => {\r\n\t\t\tif (_root.isSelected) {\r\n\t\t\t\tresult.push(_root.id);\r\n\t\t\t\teach(_root._children, (_child: Permission) => {\r\n\t\t\t\t\tif (_child.isSelected) {\r\n\t\t\t\t\t\tresult.push(_child.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprepareRole(): Role {\r\n\t\tconst _role = new Role();\r\n\t\t_role.id = this.role.id;\r\n\t\t_role.permissions = this.preparePermissionIds();\r\n\t\t// each(this.assignedRoles, (_role: Role) => _user.roles.push(_role.id));\r\n\t\t_role.title = this.role.title;\r\n\t\t_role.isCoreRole = this.role.isCoreRole;\r\n\t\treturn _role;\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tthis.hasFormErrors = false;\r\n\t\tthis.loadingAfterSubmit = false;\r\n\t\t/** check form */\r\n\t\tif (!this.isTitleValid()) {\r\n\t\t\tthis.hasFormErrors = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst editedRole = this.prepareRole();\r\n\t\tif (editedRole.id) {\r\n\t\t\tthis.updateRole(editedRole);\r\n\t\t} else {\r\n\t\t\tthis.createRole(editedRole);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateRole(_role: Role) {\r\n\t\tthis.loadingAfterSubmit = true;\r\n\t\tthis.viewLoading = true;\r\n\t\t/* Server loading imitation. Remove this on real code */\r\n\t\tconst updateRole: Update<Role> = {\r\n\t\t\tid: this.role.id,\r\n\t\t\tchanges: _role\r\n\t\t};\r\n\t\tthis.store.dispatch(new RoleUpdated({\r\n\t\t\tpartialrole: updateRole,\r\n\t\t\trole: _role\r\n\t\t}));\r\n\t\tof(undefined).subscribe(() => { // Remove this line\r\n\t\t\tthis.viewLoading = false;\r\n\t\t\tthis.dialogRef.close({\r\n\t\t\t\t_role,\r\n\t\t\t\tisEdit: true\r\n\t\t\t});\r\n\t\t}); // Remove this line\r\n\t}\r\n\r\n\tcreateRole(_role: Role) {\r\n\t\tthis.loadingAfterSubmit = true;\r\n\t\tthis.viewLoading = true;\r\n\t\tthis.store.dispatch(new RoleOnServerCreated({ role: _role }));\r\n\t\tthis.componentSubscriptions = this.store.pipe(\r\n\t\t\tdelay(1000), // Remove this line\r\n\t\t\tselect(selectLastCreatedRoleId)\r\n\t\t).subscribe(res => {\r\n\t\t\tif (!res) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.viewLoading = false;\r\n\t\t\tthis.dialogRef.close({\r\n\t\t\t\t_role,\r\n\t\t\t\tisEdit: false\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tonAlertClose($event) {\r\n\t\tthis.hasFormErrors = false;\r\n\t}\r\n\r\n\tisSelectedChanged($event, permission: Permission) {\r\n\t\tif (permission._children.length === 0 && permission.isSelected) {\r\n\t\t\tconst _root = find(this.rolePermissions, (item: Permission) => item.id === permission.parentId);\r\n\t\t\tif (_root && !_root.isSelected) {\r\n\t\t\t\t_root.isSelected = true;\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (permission._children.length === 0 && !permission.isSelected) {\r\n\t\t\tconst _root = find(this.rolePermissions, (item: Permission) => item.id === permission.parentId);\r\n\t\t\tif (_root && _root.isSelected) {\r\n\t\t\t\tif (!some(_root._children, (item: Permission) => item.isSelected === true)) {\r\n\t\t\t\t\t_root.isSelected = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (permission._children.length > 0 && permission.isSelected) {\r\n\t\t\teach(permission._children, (item: Permission) => item.isSelected = true);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (permission._children.length > 0 && !permission.isSelected) {\r\n\t\t\teach(permission._children, (item: Permission) => {\r\n\t\t\t\titem.isSelected = false;\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTitle(): string {\r\n\t\tif (this.role && this.role.id) {\r\n\t\t\treturn `Edit role '${this.role.title}'`;\r\n\t\t}\r\n\t\treturn 'New role';\r\n\t}\r\n\r\n\tisTitleValid(): boolean {\r\n\t\treturn (this.role && this.role.title && this.role.title.length > 0);\r\n\t}\r\n}\r\n"]}