"use strict";var __decorate=this&&this.__decorate||function(t,e,o,r){var i,s=arguments.length,n=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(n=(s<3?i(n):3<s?i(e,o,n):i(e,o))||n);return 3<s&&n&&Object.defineProperty(e,o,n),n};exports.__esModule=!0;var core_1=require("@angular/core"),forms_1=require("@angular/forms"),rxjs_1=require("rxjs"),operators_1=require("rxjs/operators"),auth_1=require("../../../../core/auth"),DEMO_PARAMS={EMAIL:"admin@demo.com",PASSWORD:"demo"},LoginComponent=function(){function t(t,e,o,r,i,s,n,a){this.router=t,this.auth=e,this.authNoticeService=o,this.translate=r,this.store=i,this.fb=s,this.cdr=n,this.route=a,this.loading=!1,this.errors=[],this.unsubscribe=new rxjs_1.Subject}return t.prototype.ngOnInit=function(){var e=this;this.initLoginForm(),this.route.queryParams.subscribe(function(t){e.returnUrl=t.returnUrl||"/"})},t.prototype.ngOnDestroy=function(){this.authNoticeService.setNotice(null),this.unsubscribe.next(),this.unsubscribe.complete(),this.loading=!1},t.prototype.initLoginForm=function(){if(!this.authNoticeService.onNoticeChanged$.getValue()){var t="Use account\n\t\t\t<strong>"+DEMO_PARAMS.EMAIL+"</strong> and password\n\t\t\t<strong>"+DEMO_PARAMS.PASSWORD+"</strong> to continue.";this.authNoticeService.setNotice(t,"info")}this.loginForm=this.fb.group({email:[DEMO_PARAMS.EMAIL,forms_1.Validators.compose([forms_1.Validators.required,forms_1.Validators.email,forms_1.Validators.minLength(3),forms_1.Validators.maxLength(320)])],password:[DEMO_PARAMS.PASSWORD,forms_1.Validators.compose([forms_1.Validators.required,forms_1.Validators.minLength(3),forms_1.Validators.maxLength(100)])]})},t.prototype.submit=function(){var e=this,o=this.loginForm.controls;if(this.loginForm.invalid)Object.keys(o).forEach(function(t){return o[t].markAsTouched()});else{this.loading=!0;var t={email:o.email.value,password:o.password.value};this.auth.login(t.email,t.password).pipe(operators_1.tap(function(t){t?(e.store.dispatch(new auth_1.Login({authToken:t.accessToken})),e.router.navigateByUrl(e.returnUrl)):e.authNoticeService.setNotice(e.translate.instant("AUTH.VALIDATION.INVALID_LOGIN"),"danger")}),operators_1.takeUntil(this.unsubscribe),operators_1.finalize(function(){e.loading=!1,e.cdr.markForCheck()})).subscribe()}},t.prototype.isControlHasError=function(t,e){var o=this.loginForm.controls[t];return!!o&&(o.hasError(e)&&(o.dirty||o.touched))},t=__decorate([core_1.Component({selector:"kt-login",templateUrl:"./login.component.html",encapsulation:core_1.ViewEncapsulation.None})],t)}();exports.LoginComponent=LoginComponent;
//# sourceMappingURL=login.component.min.js.map
