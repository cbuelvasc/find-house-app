"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var p,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;0<=s;s--)(p=e[s])&&(a=(i<3?p(a):3<i?p(t,r,a):p(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a};exports.__esModule=!0;var rxjs_1=require("rxjs"),core_1=require("@angular/core"),operators_1=require("rxjs/operators"),effects_1=require("@ngrx/effects"),property_actions_1=require("../_actions/property.actions"),PropertyEffects=function(){function e(e,t,r){var p=this;this.actions$=e,this.propertiesService=t,this.store=r,this.showPageLoadingDistpatcher=new property_actions_1.PropertiesPageToggleLoading({isLoading:!0}),this.showLoadingDistpatcher=new property_actions_1.PropertiesPageToggleLoading({isLoading:!0}),this.hideActionLoadingDistpatcher=new property_actions_1.PropertiesPageToggleLoading({isLoading:!1}),this.loadPropertiesPage$=this.actions$.pipe(effects_1.ofType(property_actions_1.PropertyActionTypes.PropertiesPageRequested),operators_1.mergeMap(function(e){var t=e.payload;p.store.dispatch(p.showPageLoadingDistpatcher);var r=p.propertiesService.findProperties(t.page),o=rxjs_1.of(t.page);return rxjs_1.forkJoin([r,o])}),operators_1.map(function(e){var t=e[0],r=e[1];return new property_actions_1.PropertiesPageLoaded({properties:t.items,totalCount:t.totalCount,page:r})})),this.deleteproperty$=this.actions$.pipe(effects_1.ofType(property_actions_1.PropertyActionTypes.OnePropertyDeleted),operators_1.mergeMap(function(e){var t=e.payload;return p.store.dispatch(p.showLoadingDistpatcher),p.propertiesService.deleteProperty(t.id)}),operators_1.map(function(){return p.hideActionLoadingDistpatcher})),this.deleteProperties$=this.actions$.pipe(effects_1.ofType(property_actions_1.PropertyActionTypes.ManyPropertiesDeleted),operators_1.mergeMap(function(e){var t=e.payload;return p.store.dispatch(p.showLoadingDistpatcher),p.propertiesService.deleteProperties(t.ids)}),operators_1.map(function(){return p.hideActionLoadingDistpatcher})),this.updateProperty$=this.actions$.pipe(effects_1.ofType(property_actions_1.PropertyActionTypes.PropertyUpdated),operators_1.mergeMap(function(e){var t=e.payload;return p.store.dispatch(p.showLoadingDistpatcher),p.propertiesService.updateProperty(t.property)}),operators_1.map(function(){return p.hideActionLoadingDistpatcher})),this.createProperty$=this.actions$.pipe(effects_1.ofType(property_actions_1.PropertyActionTypes.PropertyOnServerCreated),operators_1.mergeMap(function(e){var t=e.payload;return p.store.dispatch(p.showLoadingDistpatcher),p.propertiesService.createProperty(t.property).pipe(operators_1.tap(function(e){p.store.dispatch(new property_actions_1.PropertyCreated({property:e}))}))}),operators_1.map(function(){return p.hideActionLoadingDistpatcher}))}return __decorate([effects_1.Effect()],e.prototype,"loadPropertiesPage$"),__decorate([effects_1.Effect()],e.prototype,"deleteproperty$"),__decorate([effects_1.Effect()],e.prototype,"deleteProperties$"),__decorate([effects_1.Effect()],e.prototype,"updateProperty$"),__decorate([effects_1.Effect()],e.prototype,"createProperty$"),e=__decorate([core_1.Injectable()],e)}();exports.PropertyEffects=PropertyEffects;
//# sourceMappingURL=property.effects.min.js.map
