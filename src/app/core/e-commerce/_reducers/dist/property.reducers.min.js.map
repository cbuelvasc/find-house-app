{"version":3,"sources":["property.reducers.ts"],"names":["store_1","require","entity_1","property_actions_1","crud_1","propertiesReducer","state","action","exports","initialPropertiesState","type","PropertyActionTypes","PropertiesPageToggleLoading","__assign","listLoading","payload","isLoading","lastCreatedPropertyId","undefined","PropertiesActionToggleLoading","actionsloading","PropertyOnServerCreated","PropertyCreated","adapter","addOne","property","id","PropertyUpdated","updateOne","partialProperty","PropertiesStatusUpdated","_partialProperties","i","properties","length","push","changes","updateMany","OnePropertyDeleted","removeOne","ManyPropertiesDeleted","removeMany","ids","PropertiesPageCancelled","lastQuery","QueryParamsModel","PropertiesPageLoaded","addMany","totalCount","page","showInitWaitingMessage","createEntityAdapter","getInitialState","getPropertiestate","createFeatureSelector","selectAll","_a","getSelectors","selectEntities","selectIds","selectTotal"],"mappings":"4RAAA,IAAAA,QAAAC,QAAA,eACAC,SAAAD,QAAA,gBAEAE,mBAAAF,QAAA,gCAEAG,OAAAH,QAAA,oBA4BA,SAAgBI,kBAAkBC,EAAgCC,GAEhE,YAFgC,IAAAD,IAAAA,EAAQE,QAAAC,wBAEhCF,EAAOG,MACb,KAAKP,mBAAAQ,oBAAoBC,4BACvB,OAAAC,SAAAA,SAAA,GACKP,GAAK,CAAEQ,YAAaP,EAAOQ,QAAQC,UAAWC,2BAAuBC,IAE5E,KAAKf,mBAAAQ,oBAAoBQ,8BACvB,OAAAN,SAAAA,SAAA,GACKP,GAAK,CAAEc,eAAgBb,EAAOQ,QAAQC,YAE7C,KAAKb,mBAAAQ,oBAAoBU,wBACvB,OAAAR,SAAA,GACKP,GAEP,KAAKH,mBAAAQ,oBAAoBW,gBACvB,OAAOd,QAAAe,QAAQC,OAAOjB,EAAOQ,QAAQU,SAAQZ,SAAAA,SAAA,GACxCP,GAAK,CAAEW,sBAAuBV,EAAOQ,QAAQU,SAASC,MAE7D,KAAKvB,mBAAAQ,oBAAoBgB,gBACvB,OAAOnB,QAAAe,QAAQK,UAAUrB,EAAOQ,QAAQc,gBAAiBvB,GAC3D,KAAKH,mBAAAQ,oBAAoBmB,wBAIvB,IAFA,IAAMC,EAA8C,GAE3CC,EAAI,EAAGA,EAAIzB,EAAOQ,QAAQkB,WAAWC,OAAQF,IACpDD,EAAmBI,KAAK,CACtBT,GAAInB,EAAOQ,QAAQkB,WAAWD,GAAGN,GACjCU,QAAS,KAKb,OAAO5B,QAAAe,QAAQc,WAAWN,EAAoBzB,GAEhD,KAAKH,mBAAAQ,oBAAoB2B,mBACvB,OAAO9B,QAAAe,QAAQgB,UAAUhC,EAAOQ,QAAQW,GAAIpB,GAC9C,KAAKH,mBAAAQ,oBAAoB6B,sBACvB,OAAOhC,QAAAe,QAAQkB,WAAWlC,EAAOQ,QAAQ2B,IAAKpC,GAChD,KAAKH,mBAAAQ,oBAAoBgC,wBACvB,OAAA9B,SAAAA,SAAA,GACKP,GAAK,CAAEQ,aAAa,EAAO8B,UAAW,IAAIxC,OAAAyC,iBAAiB,MAElE,KAAK1C,mBAAAQ,oBAAoBmC,qBACvB,OAAOtC,QAAAe,QAAQwB,QAAQxC,EAAOQ,QAAQkB,WAAUpB,SAAAA,SAAA,GAC3CL,QAAAC,wBAAsB,CACzBuC,WAAYzC,EAAOQ,QAAQiC,WAC3BlC,aAAa,EACb8B,UAAWrC,EAAOQ,QAAQkC,KAC1BC,wBAAwB,KAE5B,QACE,OAAO5C,GA/DAE,QAAAe,QAAwCrB,SAAAiD,sBAExC3C,QAAAC,uBAA0CD,QAAAe,QAAQ6B,gBAAgB,CAC7EtC,aAAa,EACbM,gBAAgB,EAChB4B,WAAY,EACZJ,UAAW,IAAIxC,OAAAyC,iBAAiB,IAChC5B,2BAAuBC,EACvBgC,wBAAwB,IAG1B1C,QAAAH,kBAAAA,kBAwDaG,QAAA6C,kBAAoBrD,QAAAsD,sBAAqC,cAGpE9C,QAAA+C,WADWC,GAKThD,QAAAe,QAAQkC,gBAAcF,UAHxB/C,QAAAkD,eAAcF,GAAAE,eACdlD,QAAAmD,UAASH,GAAAG,UACTnD,QAAAoD,YAAWJ,GAAAI","file":"property.reducers.min.js","sourcesContent":["import { createFeatureSelector } from '@ngrx/store';\r\nimport { EntityState, EntityAdapter, createEntityAdapter, Update } from '@ngrx/entity';\r\n\r\nimport { PropertyActions, PropertyActionTypes } from '../_actions/property.actions';\r\nimport { PropertyModel } from '../_models/property.model';\r\nimport { QueryParamsModel } from '../../_base/crud';\r\n\r\nexport interface PropertiesState extends EntityState<PropertyModel> {\r\n\r\n  listLoading: boolean;\r\n\r\n  actionsloading: boolean;\r\n\r\n  totalCount: number;\r\n\r\n  lastQuery: QueryParamsModel;\r\n\r\n  lastCreatedPropertyId: string;\r\n\r\n  showInitWaitingMessage: boolean;\r\n}\r\n\r\nexport const adapter: EntityAdapter<PropertyModel> = createEntityAdapter<PropertyModel>();\r\n\r\nexport const initialPropertiesState: PropertiesState = adapter.getInitialState({\r\n  listLoading: false,\r\n  actionsloading: false,\r\n  totalCount: 0,\r\n  lastQuery: new QueryParamsModel({}),\r\n  lastCreatedPropertyId: undefined,\r\n  showInitWaitingMessage: true\r\n});\r\n\r\nexport function propertiesReducer(state = initialPropertiesState, action: PropertyActions): PropertiesState {\r\n\r\n  switch (action.type) {\r\n    case PropertyActionTypes.PropertiesPageToggleLoading:\r\n      return {\r\n        ...state, listLoading: action.payload.isLoading, lastCreatedPropertyId: undefined\r\n      };\r\n    case PropertyActionTypes.PropertiesActionToggleLoading:\r\n      return {\r\n        ...state, actionsloading: action.payload.isLoading\r\n      };\r\n    case PropertyActionTypes.PropertyOnServerCreated:\r\n      return {\r\n        ...state\r\n      };\r\n    case PropertyActionTypes.PropertyCreated:\r\n      return adapter.addOne(action.payload.property, {\r\n        ...state, lastCreatedPropertyId: action.payload.property.id\r\n      });\r\n    case PropertyActionTypes.PropertyUpdated:\r\n      return adapter.updateOne(action.payload.partialProperty, state);\r\n    case PropertyActionTypes.PropertiesStatusUpdated: {\r\n      // tslint:disable-next-line\r\n      const _partialProperties: Update<PropertyModel>[] = [];\r\n      // tslint:disable-next-line\r\n      for (let i = 0; i < action.payload.properties.length; i++) {\r\n        _partialProperties.push({\r\n          id: action.payload.properties[i].id,\r\n          changes: {\r\n            // status: action.payload.status\r\n          }\r\n        });\r\n      }\r\n      return adapter.updateMany(_partialProperties, state);\r\n    }\r\n    case PropertyActionTypes.OnePropertyDeleted:\r\n      return adapter.removeOne(action.payload.id, state);\r\n    case PropertyActionTypes.ManyPropertiesDeleted:\r\n      return adapter.removeMany(action.payload.ids, state);\r\n    case PropertyActionTypes.PropertiesPageCancelled:\r\n      return {\r\n        ...state, listLoading: false, lastQuery: new QueryParamsModel({})\r\n      };\r\n    case PropertyActionTypes.PropertiesPageLoaded:\r\n      return adapter.addMany(action.payload.properties, {\r\n        ...initialPropertiesState,\r\n        totalCount: action.payload.totalCount,\r\n        listLoading: false,\r\n        lastQuery: action.payload.page,\r\n        showInitWaitingMessage: false\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const getPropertiestate = createFeatureSelector<PropertyModel>('properties');\r\n\r\nexport const {\r\n  selectAll,\r\n  selectEntities,\r\n  selectIds,\r\n  selectTotal\r\n} = adapter.getSelectors();\r\n"]}