{"version":3,"sources":["product.reducers.ts"],"names":["store_1","require","entity_1","product_actions_1","crud_1","productsReducer","state","action","exports","initialProductsState","type","ProductActionTypes","ProductsPageToggleLoading","__assign","listLoading","payload","isLoading","lastCreatedProductId","undefined","ProductsActionToggleLoading","actionsloading","ProductOnServerCreated","ProductCreated","adapter","addOne","product","id","ProductUpdated","updateOne","partialProduct","ProductsStatusUpdated","_partialProducts","i","products","length","push","changes","status","updateMany","OneProductDeleted","removeOne","ManyProductsDeleted","removeMany","ids","ProductsPageCancelled","lastQuery","QueryParamsModel","ProductsPageLoaded","addMany","totalCount","page","showInitWaitingMessage","createEntityAdapter","getInitialState","getProductState","createFeatureSelector","selectAll","_a","getSelectors","selectEntities","selectIds","selectTotal"],"mappings":"4RAEA,IAAAA,QAAAC,QAAA,eACAC,SAAAD,QAAA,gBAEAE,kBAAAF,QAAA,+BAEAG,OAAAH,QAAA,oBAwBA,SAAgBI,gBAAgBC,EAA8BC,GAC5D,YAD8B,IAAAD,IAAAA,EAAQE,QAAAC,sBAC9BF,EAAOG,MACb,KAAKP,kBAAAQ,mBAAmBC,0BACtB,OAAAC,SAAAA,SAAA,GACKP,GAAK,CAAEQ,YAAaP,EAAOQ,QAAQC,UAAWC,0BAAsBC,IAE3E,KAAKf,kBAAAQ,mBAAmBQ,4BACtB,OAAAN,SAAAA,SAAA,GACKP,GAAK,CAAEc,eAAgBb,EAAOQ,QAAQC,YAE7C,KAAKb,kBAAAQ,mBAAmBU,uBACtB,OAAAR,SAAA,GACKP,GAEP,KAAKH,kBAAAQ,mBAAmBW,eACtB,OAAOd,QAAAe,QAAQC,OAAOjB,EAAOQ,QAAQU,QAAOZ,SAAAA,SAAA,GACvCP,GAAK,CAAEW,qBAAsBV,EAAOQ,QAAQU,QAAQC,MAE3D,KAAKvB,kBAAAQ,mBAAmBgB,eACtB,OAAOnB,QAAAe,QAAQK,UAAUrB,EAAOQ,QAAQc,eAAgBvB,GAC1D,KAAKH,kBAAAQ,mBAAmBmB,sBAItB,IAFA,IAAMC,EAA2C,GAExCC,EAAI,EAAGA,EAAIzB,EAAOQ,QAAQkB,SAASC,OAAQF,IAClDD,EAAiBI,KAAK,CACpBT,GAAInB,EAAOQ,QAAQkB,SAASD,GAAGN,GAC/BU,QAAS,CACPC,OAAQ9B,EAAOQ,QAAQsB,UAI7B,OAAO7B,QAAAe,QAAQe,WAAWP,EAAkBzB,GAE9C,KAAKH,kBAAAQ,mBAAmB4B,kBACtB,OAAO/B,QAAAe,QAAQiB,UAAUjC,EAAOQ,QAAQW,GAAIpB,GAC9C,KAAKH,kBAAAQ,mBAAmB8B,oBACtB,OAAOjC,QAAAe,QAAQmB,WAAWnC,EAAOQ,QAAQ4B,IAAKrC,GAChD,KAAKH,kBAAAQ,mBAAmBiC,sBACtB,OAAA/B,SAAAA,SAAA,GACKP,GAAK,CAAEQ,aAAa,EAAO+B,UAAW,IAAIzC,OAAA0C,iBAAiB,MAElE,KAAK3C,kBAAAQ,mBAAmBoC,mBACtB,OAAOvC,QAAAe,QAAQyB,QAAQzC,EAAOQ,QAAQkB,SAAQpB,SAAAA,SAAA,GACzCL,QAAAC,sBAAoB,CACvBwC,WAAY1C,EAAOQ,QAAQkC,WAC3BnC,aAAa,EACb+B,UAAWtC,EAAOQ,QAAQmC,KAC1BC,wBAAwB,KAE5B,QACE,OAAO7C,GA9DAE,QAAAe,QAAuCrB,SAAAkD,sBAEvC5C,QAAAC,qBAAsCD,QAAAe,QAAQ8B,gBAAgB,CACzEvC,aAAa,EACbM,gBAAgB,EAChB6B,WAAY,EACZJ,UAAW,IAAIzC,OAAA0C,iBAAiB,IAChC7B,0BAAsBC,EACtBiC,wBAAwB,IAG1B3C,QAAAH,gBAAAA,gBAuDaG,QAAA8C,gBAAkBtD,QAAAuD,sBAAoC,YAGjE/C,QAAAgD,WADWC,GAKTjD,QAAAe,QAAQmC,gBAAcF,UAHxBhD,QAAAmD,eAAcF,GAAAE,eACdnD,QAAAoD,UAASH,GAAAG,UACTpD,QAAAqD,YAAWJ,GAAAI","file":"product.reducers.min.js","sourcesContent":["\r\n// NGRX\r\nimport { createFeatureSelector } from '@ngrx/store';\r\nimport { EntityState, EntityAdapter, createEntityAdapter, Update } from '@ngrx/entity';\r\n// Actions\r\nimport { ProductActions, ProductActionTypes } from '../_actions/product.actions';\r\n// CRUD\r\nimport { QueryParamsModel } from '../../_base/crud';\r\n// Models\r\nimport { ProductModel } from '../_models/product.model';\r\n\r\nexport interface ProductsState extends EntityState<ProductModel> {\r\n  listLoading: boolean;\r\n  actionsloading: boolean;\r\n  totalCount: number;\r\n  lastQuery: QueryParamsModel;\r\n  lastCreatedProductId: string;\r\n  showInitWaitingMessage: boolean;\r\n}\r\n\r\nexport const adapter: EntityAdapter<ProductModel> = createEntityAdapter<ProductModel>();\r\n\r\nexport const initialProductsState: ProductsState = adapter.getInitialState({\r\n  listLoading: false,\r\n  actionsloading: false,\r\n  totalCount: 0,\r\n  lastQuery: new QueryParamsModel({}),\r\n  lastCreatedProductId: undefined,\r\n  showInitWaitingMessage: true\r\n});\r\n\r\nexport function productsReducer(state = initialProductsState, action: ProductActions): ProductsState {\r\n  switch (action.type) {\r\n    case ProductActionTypes.ProductsPageToggleLoading:\r\n      return {\r\n        ...state, listLoading: action.payload.isLoading, lastCreatedProductId: undefined\r\n      };\r\n    case ProductActionTypes.ProductsActionToggleLoading:\r\n      return {\r\n        ...state, actionsloading: action.payload.isLoading\r\n      };\r\n    case ProductActionTypes.ProductOnServerCreated:\r\n      return {\r\n        ...state\r\n      };\r\n    case ProductActionTypes.ProductCreated:\r\n      return adapter.addOne(action.payload.product, {\r\n        ...state, lastCreatedProductId: action.payload.product.id\r\n      });\r\n    case ProductActionTypes.ProductUpdated:\r\n      return adapter.updateOne(action.payload.partialProduct, state);\r\n    case ProductActionTypes.ProductsStatusUpdated: {\r\n      // tslint:disable-next-line\r\n      const _partialProducts: Update<ProductModel>[] = [];\r\n      // tslint:disable-next-line\r\n      for (let i = 0; i < action.payload.products.length; i++) {\r\n        _partialProducts.push({\r\n          id: action.payload.products[i].id,\r\n          changes: {\r\n            status: action.payload.status\r\n          }\r\n        });\r\n      }\r\n      return adapter.updateMany(_partialProducts, state);\r\n    }\r\n    case ProductActionTypes.OneProductDeleted:\r\n      return adapter.removeOne(action.payload.id, state);\r\n    case ProductActionTypes.ManyProductsDeleted:\r\n      return adapter.removeMany(action.payload.ids, state);\r\n    case ProductActionTypes.ProductsPageCancelled:\r\n      return {\r\n        ...state, listLoading: false, lastQuery: new QueryParamsModel({})\r\n      };\r\n    case ProductActionTypes.ProductsPageLoaded:\r\n      return adapter.addMany(action.payload.products, {\r\n        ...initialProductsState,\r\n        totalCount: action.payload.totalCount,\r\n        listLoading: false,\r\n        lastQuery: action.payload.page,\r\n        showInitWaitingMessage: false\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const getProductState = createFeatureSelector<ProductModel>('products');\r\n\r\nexport const {\r\n  selectAll,\r\n  selectEntities,\r\n  selectIds,\r\n  selectTotal\r\n} = adapter.getSelectors();\r\n"]}