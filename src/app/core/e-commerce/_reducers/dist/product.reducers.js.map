{"version":3,"sources":["product.reducers.ts"],"names":[],"mappings":"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","file":"product.reducers.js","sourcesContent":["\r\n// NGRX\r\nimport { createFeatureSelector } from '@ngrx/store';\r\nimport { EntityState, EntityAdapter, createEntityAdapter, Update } from '@ngrx/entity';\r\n// Actions\r\nimport { ProductActions, ProductActionTypes } from '../_actions/product.actions';\r\n// CRUD\r\nimport { QueryParamsModel } from '../../_base/crud';\r\n// Models\r\nimport { ProductModel } from '../_models/product.model';\r\n\r\nexport interface ProductsState extends EntityState<ProductModel> {\r\n  listLoading: boolean;\r\n  actionsloading: boolean;\r\n  totalCount: number;\r\n  lastQuery: QueryParamsModel;\r\n  lastCreatedProductId: string;\r\n  showInitWaitingMessage: boolean;\r\n}\r\n\r\nexport const adapter: EntityAdapter<ProductModel> = createEntityAdapter<ProductModel>();\r\n\r\nexport const initialProductsState: ProductsState = adapter.getInitialState({\r\n  listLoading: false,\r\n  actionsloading: false,\r\n  totalCount: 0,\r\n  lastQuery: new QueryParamsModel({}),\r\n  lastCreatedProductId: undefined,\r\n  showInitWaitingMessage: true\r\n});\r\n\r\nexport function productsReducer(state = initialProductsState, action: ProductActions): ProductsState {\r\n  switch (action.type) {\r\n    case ProductActionTypes.ProductsPageToggleLoading:\r\n      return {\r\n        ...state, listLoading: action.payload.isLoading, lastCreatedProductId: undefined\r\n      };\r\n    case ProductActionTypes.ProductsActionToggleLoading:\r\n      return {\r\n        ...state, actionsloading: action.payload.isLoading\r\n      };\r\n    case ProductActionTypes.ProductOnServerCreated:\r\n      return {\r\n        ...state\r\n      };\r\n    case ProductActionTypes.ProductCreated:\r\n      return adapter.addOne(action.payload.product, {\r\n        ...state, lastCreatedProductId: action.payload.product.id\r\n      });\r\n    case ProductActionTypes.ProductUpdated:\r\n      return adapter.updateOne(action.payload.partialProduct, state);\r\n    case ProductActionTypes.ProductsStatusUpdated: {\r\n      // tslint:disable-next-line\r\n      const _partialProducts: Update<ProductModel>[] = [];\r\n      // tslint:disable-next-line\r\n      for (let i = 0; i < action.payload.products.length; i++) {\r\n        _partialProducts.push({\r\n          id: action.payload.products[i].id,\r\n          changes: {\r\n            status: action.payload.status\r\n          }\r\n        });\r\n      }\r\n      return adapter.updateMany(_partialProducts, state);\r\n    }\r\n    case ProductActionTypes.OneProductDeleted:\r\n      return adapter.removeOne(action.payload.id, state);\r\n    case ProductActionTypes.ManyProductsDeleted:\r\n      return adapter.removeMany(action.payload.ids, state);\r\n    case ProductActionTypes.ProductsPageCancelled:\r\n      return {\r\n        ...state, listLoading: false, lastQuery: new QueryParamsModel({})\r\n      };\r\n    case ProductActionTypes.ProductsPageLoaded:\r\n      return adapter.addMany(action.payload.products, {\r\n        ...initialProductsState,\r\n        totalCount: action.payload.totalCount,\r\n        listLoading: false,\r\n        lastQuery: action.payload.page,\r\n        showInitWaitingMessage: false\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const getProductState = createFeatureSelector<ProductModel>('products');\r\n\r\nexport const {\r\n  selectAll,\r\n  selectEntities,\r\n  selectIds,\r\n  selectTotal\r\n} = adapter.getSelectors();\r\n"]}